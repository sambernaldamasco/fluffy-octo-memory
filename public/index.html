<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app="BlogApp">

<head>
  <meta charset="utf-8">
  <title>Blogs</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.8/angular.min.js" charset="utf-8"> </script>
  <script src="/js/app.js" charset="utf-8"></script>

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/main.css">

</head>

<body ng-controller="MainController as ctrl">
<!-- whole body container -->
<div class="container">
  <h2>Super Duper Blog</h2>
  <button ng-click="ctrl.createNewPost = true">Add new post</button>

  <form ng-if="ctrl.createNewPost" ng-submit="ctrl.createPosts()">
    <input type="text" ng-model="ctrl.author" placeholder="author's name"><br>
    <input type="text" ng-model="ctrl.title" placeholder="title"><br>
    <textarea ng-model="ctrl.description"></textarea><br>
    <input type="submit" value="submit"> <button ng-click="ctrl.createNewPost = false">cancel</button>
  </form>

  <ul ng-repeat="post in ctrl.posts">

    <!-- adding conditions to toggle description on click of title -->
    <li><a href="#" ng-click="ctrl.toggleDetails();ctrl.indexOfShowForm = $index;"> {{post.title}}</a> - By {{post.author}}</li>
    <div ng-if="($index === ctrl.indexOfShowForm && ctrl.showDetails===true)">
    <li>{{post.description}}</li>
    <li>posted on: {{post.date}}</li>
    <li>likes: {{post.likes}}</li>

    <button ng-click="ctrl.addLikes(post)">like this post</button>
    <button
      ng-click="ctrl.indexOfEditForm = $index; ctrl.updatedDescription = post.description"
      ng-if="$index !== ctrl.indexOfEditForm">
        edit
    </button>

    <button
      ng-click="ctrl.deletePosts(post._id)">
       delete this
    </button>

    <form
      ng-if="$index === ctrl.indexOfEditForm"
      ng-submit="ctrl.editPosts(post)">
         <input type="text" ng-model="ctrl.updatedTitle" placeholder="new title">
         <textarea ng-model="ctrl.updatedDescription"></textarea>
         <input type="submit" value="Edit this Post">
    </form>
</div>
  </ul>


</div>
</body>

</html>
